name: watchtower
services:

  watchtower:
    # Using :latest tag to ensure Watchtower itself stays updated
    image: containrrr/watchtower:latest
    restart: always
    environment:
      # Set timezone to Pacific Time (Seattle)
      TZ: America/Los_Angeles
      # Check for updates every 24 hours (in seconds)
      WATCHTOWER_POLL_INTERVAL: 86400
      # Clean up old images after updating
      WATCHTOWER_CLEANUP: "true"
      # Include stopped containers in monitoring
      WATCHTOWER_INCLUDE_STOPPED: "true"
      # Run once and exit (set to false for continuous monitoring)
      WATCHTOWER_RUN_ONCE: "false"
      # Enable debug logging
      WATCHTOWER_DEBUG: "false"
      # Pushover notification settings (configure via .env file)
      WATCHTOWER_NOTIFICATIONS: shoutrrr
      WATCHTOWER_NOTIFICATION_URL: pushover://shoutrrr:${PUSHOVER_APP_TOKEN}@${PUSHOVER_USER_KEY}
    volumes:
      # Mount Docker socket to allow Watchtower to manage containers
      # NOTE: This grants full Docker daemon access - only use in trusted environments
      - /var/run/docker.sock:/var/run/docker.sock
